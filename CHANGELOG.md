# 更新日志 (Changelog)

本文档记录数字人形象库管理系统的重要版本变更。

## [2025.8.4] - 重大界面优化与版本管理系统

### 🎉 新增功能

#### 模型版本管理系统
- ✅ **新增版本字段**：支持语义化版本号（如 1.0.0）
- ✅ **状态管理增强**：完整的 5 状态流转（草稿、待审核、处理中、就绪、错误）
- ✅ **编辑对话框**：新增 `EditAvatarModal.vue` 模型编辑界面
- ✅ **API 端点**：新增 `PUT/PATCH /api/avatars/:id` 管理接口
- ✅ **数据库架构**：自动应用 Directus schema 更新

#### 用户体验重构
- ✅ **简化导航**：移除独立的"语音动画导出"和"动作表情测试"菜单项
- ✅ **集成操作**：功能按钮直接集成到模型卡片中
- ✅ **上下文保持**：从模型选择到功能使用的无缝体验
- ✅ **智能跳转**：自动传递模型ID和名称到目标页面

### 🔧 技术改进

#### 前端架构
- ✅ **组件自动导入**：优化 Vue 组件导入机制
- ✅ **类型安全**：修复 TypeScript 类型定义问题
- ✅ **响应式优化**：移动端界面适配改进

#### 后端API
- ✅ **RESTful 设计**：标准化的模型管理 API
- ✅ **错误处理**：完善的日志记录和错误追踪
- ✅ **批量操作**：支持批量更新模型状态

### 🎨 界面设计

#### 模型卡片重设计
- 🎬 **主要功能**：语音动画导出（绿色按钮，突出显示）
- 🧪 **测试功能**：动作表情测试（灰色按钮，辅助功能）
- 📱 **移动优化**：垂直按钮布局，增大触摸区域

#### 导航简化
- **移除菜单项**：语音动画导出、动作表情测试
- **保留核心**：模型管理（管理员）、模型展示（所有用户）
- **移动友好**：更简洁的移动端导航菜单

### 🔄 工作流程优化

#### 用户操作流程
```diff
- 旧流程: 主页 → 模型展示 → 返回菜单 → 语音动画 → 重选模型
+ 新流程: 主页 → 模型展示 → 选择模型 → 直接使用功能
```

#### 管理员工作流
- ✅ **版本更新**：直接在模型列表中编辑版本信息
- ✅ **状态管理**：一键切换模型状态
- ✅ **批量操作**：支持批量状态更新（API层面）

### 📚 文档更新

#### 项目文档
- ✅ **README.md**：更新核心功能说明和部署指南
- ✅ **frontend/README.md**：重写用户界面和工作流程文档
- ✅ **环境规范**：明确本地测试使用 stage 环境

#### 技术文档
- ✅ **API 文档**：新增版本管理 API 说明
- ✅ **架构图**：更新用户体验流程图
- ✅ **数据模型**：完善 avatars 集合字段说明

### ⚠️ 重要变更

#### 环境配置规范
```bash
# ✅ 推荐：本地测试
docker-compose -f docker-compose.stage.yml up -d

# ❌ 避免：本地使用生产配置  
docker-compose -f docker-compose.prod.yml up -d
```

#### 数据库迁移
- **自动应用**：通过 `directus schema apply` 自动更新
- **备份建议**：更新前自动创建架构备份
- **字段新增**：`version` 和 `status` 字段已添加到 avatars 表

### 🐛 问题修复

- ✅ **类型错误**：修复 Vue 组件 TypeScript 类型问题
- ✅ **路径解析**：统一使用相对路径导入
- ✅ **排序冲突**：修复 Directus 字段排序冲突问题
- ✅ **构建优化**：解决前端构建警告

### 📱 移动端优化

#### Animate.vue 页面
- ✅ **时间轴简化**：移动端显示更少的时间标记
- ✅ **按钮优化**：增大触摸区域，改善操作体验
- ✅ **布局调整**：垂直布局优化，减少横向滚动

#### 通用组件
- ✅ **响应式设计**：所有按钮支持移动端触摸
- ✅ **字体缩放**：移动端自动调整字体大小
- ✅ **间距优化**：增大移动端点击区域

---

## [历史版本]

### [2024.7.10] - 基础功能实现
- 🎯 基础3D模型展示功能
- 🎯 Azure TTS 语音合成集成
- 🎯 用户权限管理系统
- 🎯 Directus 后端集成

### [2025.6.15] - 项目初始化
- 🎯 Vue 3 + TypeScript 前端架构
- 🎯 Docker 容器化部署
- 🎯 基础UI组件库

---

## 贡献指南

1. **环境配置**：确保使用 `docker-compose.stage.yml` 进行本地测试
2. **代码规范**：遵循 TypeScript 严格模式和 Vue 3 最佳实践
3. **提交格式**：使用语义化提交信息
4. **文档更新**：重要变更需同步更新相关文档

## 技术支持

- 📚 **文档中心**：[frontend/README.md](./frontend/README.md)
- 🐛 **问题反馈**：通过 Issues 提交问题
- 💬 **讨论交流**：项目讨论区
