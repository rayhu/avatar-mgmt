# Azure App Service Deployment
# Using Azure App Service with Container support

apiVersion: 2021-03-01
location: eastus
name: avatar-mgmt-app
properties:
  serverFarmId: /subscriptions/{subscription-id}/resourceGroups/{resource-group}/providers/Microsoft.Web/serverfarms/avatar-mgmt-plan
  siteConfig:
    linuxFxVersion: "DOCKER|your-registry.azurecr.io/avatar-mgmt-api:latest"
    appSettings:
    - name: WEBSITES_ENABLE_APP_SERVICE_STORAGE
      value: "false"
    - name: DOCKER_REGISTRY_SERVER_URL
      value: "https://your-registry.azurecr.io"
    - name: DOCKER_REGISTRY_SERVER_USERNAME
      value: "your-registry-username"
    - name: DOCKER_REGISTRY_SERVER_PASSWORD
      value: "your-registry-password"
    - name: NODE_ENV
      value: "production"
    - name: DATABASE_URL
      value: "your-postgres-connection-string"
    - name: WEBSITES_PORT
      value: "3000"
  httpsOnly: true 
